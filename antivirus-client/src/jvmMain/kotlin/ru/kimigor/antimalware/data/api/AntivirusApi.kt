package ru.kimigor.antimalware.data.api

import kotlinx.coroutines.flow.SharedFlow
import kotlinx.coroutines.flow.StateFlow
import ru.kimigor.antimalware.data.models.ApiMessage
import ru.kimigor.antimalware.data.models.ScannerCacheData
import ru.kimigor.antimalware.data.models.structs.MessageStruct

interface AntivirusApi {
    val incomingMessages: SharedFlow<ApiMessage<MessageStruct>>
    val scannerCacheData: StateFlow<ScannerCacheData?>

    suspend fun isProtectionEnabled(): ApiMessage<MessageStruct>
    suspend fun enableProtection(): ApiMessage<Unit>
    suspend fun disableProtection(): ApiMessage<Unit>
    suspend fun startScan(path: String): ApiMessage<Unit>
    suspend fun pauseScan(): ApiMessage<Unit>
    suspend fun stopScan(): ApiMessage<Unit>
    suspend fun resumeScan(): ApiMessage<Unit>
}